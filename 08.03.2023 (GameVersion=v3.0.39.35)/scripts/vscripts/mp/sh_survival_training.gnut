  

#if SERVER
                                      

                                                                                    
                                                                                    
                                                                                   
                                                                                              

                                                      
                                                              
                                                                
                                                   

                                                                                   

                                                    
                                                   

                                                    
                                                      

                               
                                                     
                                     
#endif

#if SERVER && DEV
                    	                                                  
                                       
                                                
                              
                                      
                                       
                              
                                   
                                         
#endif

#if CLIENT
global function ServerCallback_MonitorCommsMenuUsage
global function ServerCallback_SetCommsDialogueEnabled
#endif

const string RESPAWN_CHAMBER_TARGET_NAME = "TrainingRespawnChamber"
global const string DEATH_BOX_TARGETNAME_TRAINING = "player_death_box_training"

const string SURVIVAL_TRAINING_MOVER_SCRIPTNAME = "survival_training_mover"

const vector OLD_BLOODHOUNDSTART_POS 	= < 27260, -6238, -27548 >
const vector OLD_PLAYERSTART_POS 		= < 26328, -6235, -27540 >

const array< vector > OLD_RESPAWNBEACONS_POSITIONS =
[
	< 33894, -7936, -28916 >,
	< 33724, -7937, -28916>
]

const vector OLD_DROPSHIP_POS			= < 33741, -7948, -28916 >
const vector OLD_DROPSHIP_ANG			= < 0, 90, 0 >

const vector OLD_DUMMIE_RESPAWNLAND_POS = < 33580.6992, -8134.3999, -28915.0996 >

                   
const vector NEW_BLOODHOUNDSTART_POS 	= < -10793, 509, 1580 >
const vector NEW_PLAYERSTART_POS 		= < -11725, 512, 1577 >

                     
                          
const array< array< vector > > LOOTBIN1_COORDS =
[
	[ < -7100, 586, -16 >, < 0, -180, 0>  ], 	                                   
	[ < -7357, 348, -19 >, < 0, 90, 0 >], 		                                              
]
const array< array< vector > > LOOTBIN2_COORDS =
[
	[ < -7100, 426, -16 >, < 0, -180, 0 > ],	                                   
	[ < -7197, 348, -19 >, < 0, 90, 0 >]			                                              
]

                                      
const array< array< vector > > BLOODHOUND2_COORDS =
[
	                                         	                            
	                                         	                            
	                                        	                               
	[ < -7200, 324, -22 >, < 0, 90, 0 > ], 	                            
	[ < -7168, 338, -22 >, < 0, 90, 0 > ], 	                            
	[ < -7159, 344, -22 >, < 0, 90, 0 > ], 	                               
]


const array< vector > NEW_PATHFINDER_POS =
[
	< -4945, 515, 180 >,
	< -5560, -1072, 398>             
]

const array< vector > NEW_PATHFINDER_ANG =
[
	< 0, 90, 0 >,
	< 0, 45, 0 >             

]

                                                
const array< array< vector > > ROOFDUMMIE_COORDS =
[
	[ < -5519, -901, 398 >, 	< 0, 125, 0 >,  ], 	                      
	[ < -5486, -930,398 >, 	< 0, 90, 0 > ], 	                      
	[ < -5509, -967, 398 >, 	< 0, 85, 0 >  ]	                      
]

                                                                      
const array< array< vector > > ROOF_RESPAWNBEACON_POSITIONS =
[
	[ < -5396, -690, 395 >, < -5294, -808, 396 > ],
	[ < -5293, -983, 397 >, < -5396, -690, 395 > ]             
]

                                                     
const array< array< vector > > NEW_DROPSHIP_COORDS =
[
	[ < -5147, 1255, 24 >, < 0, 90, 0 > ],                                   
	[ < -4703, -261, 393>, < 0, 90, 0 > ],                              
	[ < -5066, -568, 398 >, < 0, 160, 0 > ]                                                     
]

                                                 
const array< vector > NEW_DUMMIELANDS_POS =
[
	< -5175, 520, 44 >,
	< -5370, -888, 398 >             
]

const array< array < vector > > NEW_DUMMIELAND_COORDS =
[
	[ < -5175, 520, 44 >, < 0, 0 , 0 >  ],
	[ < -5370, -888, 398>, < 0, -180, 0 > ]             
]


                                                                                     
const vector NPC_REF_ANGLE_ADJUST		= < 0, 90, 0 >

                                                                      
vector deltaOldNewMap = < 0, 0, 0 >

                             

#if SERVER
                                                                
 
	                                                                                   
	                                                                                   
	                                                                                  
 

                                        
                                                           
#endif

global function Tutorial_TryAction_OpenLootBin1
global function Tutorial_TryAction_OpenLootBin2
global function Tutorial_TryAction_TakeFrag
global function Tutorial_TryAction_TakeThermite
global function Tutorial_TryAction_TakeHealth
global function Tutorial_TryAction_SwapGrenade
global function Tutorial_TryAction_ThrewGrenade
global function Tutorial_TryAction_UseHealth
global function Tutorial_TryAction_PickedUpWeapon
global function Tutorial_TryAction_PickedUpAmmo
global function Tutorial_TryAction_ShotTrainingTargets
global function Tutorial_TryAction_SecondWeapon
global function Tutorial_TryAction_ThirdWeapon
global function Tutorial_TryAction_PingEnemyLocation
global function Tutorial_TryAction_PingWeapon
global function Tutorial_TryAction_PingAmmo
global function Tutorial_TryAction_PingMenu
global function Tutorial_TryAction_OrdnanceMenu
global function Tutorial_TryAction_Pathfinder
global function Tutorial_TryAction_ReviveDummy
global function Tutorial_TryAction_HealDummy
global function Tutorial_TryAction_PickUpDNA
global function Tutorial_TryAction_UsedRespawnChamber
global function Tutorial_TryAction_UsedUltimate
#if CLIENT
global function TrainingEndTimeChanged
#endif
global function ShSurvivalTraining_Init

struct PlayerTrainingData
{
	entity trainingNPC
	entity trainingDummy
	entity trainingDummyNode
	entity npcNodeBloodhound1
	entity npcNodeBloodhound2
	entity npcNodePathfinder1
	entity lootBin1
	entity lootBin2
	bool   openedLootBin1
	bool   openedLootBin2
	bool   pickedUpFrag
	bool   pickedUpThermite
	bool   pickedUpHealth
	bool   swappedGrenade
	bool   usedHealth
	bool   usedHealthDialoguePlayed
	bool   threwGrenade
	bool   threwGrenadeDialoguePlayed
	bool   shotTrainingTargets
	string firstPrimary1
	string firstPrimary2
	bool   pingedEnemyTarget
	bool   openedOrdnanceMenu
	bool   openedPingMenu
	bool   pingedWeapon
	bool   pingedAmmo
	bool   foundPathfinder
	bool   revivedDummy
	bool   healedDummy
	bool   healDroneTooFarDialoguePlayed
	entity deathBox
	bool   pickedUpDNA
	bool   usedRespawnChamber
	entity respawnChamber
	entity respawnChamberRadar
	bool   respawnChamberFirstUseDialoguePlayed
	entity dropship
	bool   usedUltimate

	bool gun_range_enabled

	bool completed_movement
	bool completed_ordnance
	bool completed_weapons
	bool completed_ping
	bool completed_pathfinder

	vector playerRandomStartOrigin
	vector bloodhoundRandomStartOrigin
}

struct
{
	table<entity, PlayerTrainingData> playerTrainingData
	table<entity, entity>             playerUltimateDropPods
#if SERVER
	                         
	                                 
#endif          

	#if CLIENT
		bool ftueTestOn = false
	#endif          
	
} file

#if DEV
void function GetWeaponNames (entity player)
{
	array<entity> weapons = player.GetAllActiveWeapons()
	foreach (weapon in weapons)
	{
		printt("Player's holding : " + weapon.GetWeaponName())
	}

}
#endif

void function ShSurvivalTraining_Init()
{
	if ( !IsSurvivalTraining() )
		return

	RegisterCSVDialogue( $"datatable/dialogue/survival_training.rpak" )

	AddCallback_EntitiesDidLoad( Training_EntitiesDidLoad )

	                                                                                                 
                    
		if( IsStagingMU1())
		{
			deltaOldNewMap = NEW_BLOODHOUNDSTART_POS - OLD_BLOODHOUNDSTART_POS

			#if SERVER
				                                                                            
				                                 
				 
					                                                                                 
					                                                                                 
					                                                                                 
				 
			#endif          
		}
                          

	Remote_RegisterServerFunction( "ClientCallback_TrainingUsedCommsMenu", "int", 0, 2 )
	Remote_RegisterServerFunction( "ClientCallback_SetProceedToFiringRange", "bool" )

	#if SERVER
		                                                  
		                                          
		                                   
		                                          
		                                   
		                                                        

		                                     
		                                     

		                                               

		                                                  
		                                                        
		                                                           
		                                                           
		                                                                        
		                                                      

		       
			                                                                                                 
		      

		                                                   

		                                    
	#endif

	#if CLIENT
		AddLocalPlayerFunc( Training_AddPlayer )
		AddCallback_OnClientScriptInit( OnLocalClientConnected )
		AddTargetNameCreateCallback( RESPAWN_CHAMBER_TARGET_NAME, RespawnChamberCreated )
		RegisterNetVarTimeChangeCallback( "TrainingEndTime", TrainingEndTimeChanged )
		SetCommsDialogueEnabled( false )

		AddCreateCallback( "prop_death_box", TrainingDeathBoxCreated )
	#endif
}

#if CLIENT
void function RespawnChamberCreated( entity ent )
{
	printt( "Training: RespawnChamberCreated", ent )
	AddCallback_OnUseEntity_ClientServer( ent, Training_RespawnChamberOnUse )
}
#endif

void function Training_EntitiesDidLoad()
{
	printt( "Training: EntitiesDidLoad" )
	#if SERVER
		                                         
                     
			                             
			                                     
        

		                            
	#endif
}

#if SERVER
                                          
 
	                                                                             
	                                   
	 
		                                                      
	 
 

                                                                      
 
	                         
		      

	       
		                                                                                         
	      

	                                        
	                                                                  
	                  
	             
	                         
	 
		                               
		                                     
		                               
		                                      
		                                    
		                             
		                                  
		                           
			                                                      
			                                          
			     
		                                 
			                                                      
			                                             
			     
		                                       
		                             
		                                  
		                                    
		                                         
		                                  
		                                      
		                                           
		                               
		                                    
			                                                       
			                                           
			     
		        
			                                 
			                    
			     
	 

	                                                                     
 

                                                                                                          
 
	                                                          
	             
	                      
	           
	                        
		      

	                                                            
	                    
	                               
	                          
	                                                           
 
#endif          

                   
bool function IsStagingMU1()
{
	return( GetMapName() == "mp_rr_canyonlands_staging_mu1" )
}
                         

#if SERVER
                                                
 
	                                                                 

	                            
	                                              
	                       

	                                                                                
	                                                            
	                                                                    

	                                              
	                                         
 

                                                   
 
	                                          

	                                  
	                                           
		      

	                                                           

	                                  
		                          
	                                    
		                            
	                                        
		                                
	                                         
		                                 
	                                         
		                                 
	                                         
		                                 
	                               
		                       
	                               
		                       
	                               
		                       
	                                     
		                             
	                                          
		                                  
	                               
		                       

	                                                                                                  
	 
		                                               
		                                            
	 

	                                        
 

                                                         
 
	                                                                                                

	                     
		      

	                                                        

	                                                              
	                                                           
	                              

	                                     
 

                                                   
 
	                                                                        
	                                                           

	                                            
	 
		                                                
	 
	    
	 
                     
		                     
		 
			                                          
		 
		    
		 
			                                       
		 
       
                                             
                           
	 

	                               

	                                         

	                                               

	                                                 
	                       
	 
		                       
		                                            
		                                 
		                                              
		                                                                                    
	 

	                                                          
	                                                                           
		                                                 
	                                                 

	                                           
	                                                                               
	                                                                                   

	                                                 
	                                               

	                              

	            
		                             
		 
			                               
				                       

			                               
				                       

			                               
				                       

			                                    
				                            

			                                        
				                                

			                                         
				                                 

			                                         
				                                 

			                                         
				                                 

			                                  
				                          

			                                          
				                                  

			                                     
				                             

			                        
			 
				                          
				                                                    
				                                                    
				                                                  
				                                            
				                                                        
				                                                              
				                                                                      

				                                            
			 
		 
	 

	           

	                              
	                           
	                           
	                         
	                             
	                           
	                           
	                       
	                                     
	                         
	                                       
	                                
	                              
	                               
	                           
	                         
	                       

	       
	                                                                                                                                                 
	                                                                                                                                                            
	                                 
	            

	                              

	                                              
	                                              
	                                  
	                                  

                    
		                    
		 
			                                                      
			                                                      
			                                   
			                                   
			                                   
			                                   
		 
       

	                                                                                                                                        

	                                                                          
	                                                                                                                                                                                       

	                      
	                                            
	                                            

	       
		                               
		 
			                                        
			      
		 
	      

	                                                                   
	 
		                                           
		                              
		                                                       
	 

	                                                                   
	 
		                                       
		                              
		                                                   
	 

	                                                                  
	 
		                                          
		                                                      
		                             
	 

	                              
	 
		                                              
		                                              

                     
			                  
			                     
			 
				                                                          
			 
			    
			 
				                                                                   
			 
       
                                                             
                              
		                                                              
	 

	                                                
	 
		                                       
		                                                   
		                          
	 

	                                 
	 
		                                         
		                                                     

		                                          
		                                                      

		                                           
		                                                       

		                                
	 

	                                                       
	                                                                           
	                                                 

	                                                           
	        
 

                                   
 
                     
	                               
		                                       
                          
	
	                                       
 

                                                                                                           
 
	                                                                
	                             
	                                                   
	                     
	                                                                
	                                                               
	                                           
	                                          
	              
 

#endif

bool function Training_IsFTUEEnabled()
{
	if( !GetConVarBool( "ftue_flow_enabled" ) )
		return false

	bool ret = false
	#if CLIENT || UI
		ret = IsFeatureSuppressed( eFeatureSuppressionFlags.TRAINING_RETURN_TO_LOBBY )
	#elseif SERVER
		                               
	#endif
	return ret
}

#if CLIENT
void function Training_AddPlayer( entity player )
{
	printt( "Training: OnLocalPlayerSpawned", player )
}

void function OnLocalClientConnected( entity player )
{
	printt( "Training: OnLocalClientConnected", player )
	Remote_ServerCallFunction( "ClientCallback_SetProceedToFiringRange", Training_IsFTUEEnabled() )
}

void function TrainingEndTimeChanged( entity player, float new )
{
	if ( new > 0 )
	{
		if ( GetFirstTimePlayerState() < eNewPlayerState.TRAINING_COMPLETED )
		{
			SetFirstTimePlayerState( eNewPlayerState.TRAINING_COMPLETED )
		}

		var rui = CreateFullscreenRui( $"ui/training_end_countdown.rpak" )

		bool plv_ftue_loads_into_firingrange = GetCurrentPlaylistVarBool( "ftue_loads_into_firingrange", true )

		if (plv_ftue_loads_into_firingrange && ( file.ftueTestOn || ( !AreWeMatchmaking() && Training_IsFTUEEnabled() )))
		{
			#if DEV
				printt( format( "%s(): Match Making for Firing Range.", FUNC_NAME()) )
			#endif
			StartMatchmakingStandard( PLAYLIST_FIRING_RANGE )
		}
		
		                                                                                       
		thread QuitToLobbyDelayed( player, new )
	}
}

void function QuitToLobbyDelayed( entity player, float time )
{
	EndSignal( player, "OnDestroy" )
	wait max( 0, time - Time() )

	if( AreWeMatchmaking() )                                                       
		CancelMatchmaking()

	ScreenFade( player, 0, 0, 0, 255, 1.5, 5.0, FFADE_OUT )
	wait 2.0
	Remote_ServerCallFunction( "ClientCallback_LeaveMatch" )
}
#endif

#if SERVER
                                                                                      
 
	                                           

	                                                                               
	                                                               

	                                                        
		          

	                     
	 
		                         
		          
	 

	                                                                                
	           

	                                                     
		                                   
	                                                          
		                                   

	                                              
	                         
	                            

	                                
	                                                         

	                                                   

	          
 

                                                          
 
	                                           

	                                                              

	                       
		            

	                                                                                             
	                                                                                                
	             
	                        
	                                                       
	                                     

	                                              
	                           
	                              

	                                  
	                                                           

	                                                       

	            
 

                                                                    
 
	                                                           

	           
	          
	                        

	                  
	 
		                          
                      
				                     
				 
					                                                                      
						                                                           
					                                            
					 
						                                                                                                                                         
					 
					    
					 
						                                                                                                                                 
						                                                                                                                                
					 
				 
				    
				 
					                       
					                             
					                   
					                                                                                                  
				 
				       
					              
						                                                             
				             
        
                                                                          
                                                                
                                                
     
                                                                                                                                              
     
        
     
                                                                                                                                      
                                                                                                                                     
     
                            

			                                                           
			           
		                          
                      
				                     
				 
					                                                                      
						                                                           
					                                                                                                                                
				 
				    
				 
					                                                
					                 
					                 
					                                                                                                  
				 
				       
					              
						                                                             
				             
        
                                                                          
                                                                
                                                                                                                                    
                            

			                                                           
			           
		                          
                      
				                     
				 
					                                                                      
						                                                           
					                                                                                                                               
				 
				    
				 
					                        
					                             
					                                                    
					                                                                                                   
				 
				       
					              
						                                                             
				             
        
                                                                          
                                                                
                                                                                                                                   
                       

			                                                           
			           
		                         
                      
				                     
				 
					                                                                     
						                                                          
					                                                                                                                                 
				 
				    
				 
					                                                                   
					                 
					                                        
					                                                                                                  
				 
				       
					              
						                                                
				             
        
                                                                         
                                                               
                                                                                                                                     
                            

			                                                          
			           
		        
			                                                         
	 

	           
 

                                                                                                              
 
	                                
	                                   
	                           
	                             

	                                                   

	                     
		                                                   
 

                                                                                                                                               
 
	                                
	                                   
	                           
	                             

	                                             
	                                                   
	                                         

	                           
		      

	                                             
	                                                   
	                                           
 

       
                                                      
 
	        

	                                                                        
	                  
	                                                                    
	                                                                                        
	                                     
	                                    
	                         
	                                                    

	                                                                           
	                     
	                                                                       
	                                                                                           
	                                      
	                                     
	                          
 
      

  
                                                                                                                                                                                                     
                                                                                                                                                                                                                   
                                                                                                                                                                                            
                                                                                                                                                                                                  
                                                                                                                                                                                                    
                                                                                                                                                                              
  

                                                     
 
	                              

	                                                
	                                                              

	                                                                     
	                                                                

	                                                                                                                                   

	                              
	             
	 
		                          
			     
		                                                             
			     
		           
	 

                    
		                   
			                                                                        
       

	                          
	                                                                                                                  
	        
	                                                                     
	                                                                                                    

	             
	                                                   
	                                                                      
	                                                                                              

	             
	                           
	                                                       

	                                                                                                            
	                                                                      
	                                                                                              
	             


	                                                                         
		        

	                                                   

	                                                                                               
	                               
	                                                                
	                                                                                

	                                          

	                                                                                        
	                      
	                         

	                                            
	 
                     
			                    
			 
				                                                    
				                       
				                                                                                          
			 
			    
			 
				                                                                      
				 
					                                                             
						                                                                                  
						     

					                                                             
						                                                                                   
						     

					                                                             
						                                                                                   
						     

					        
						                                                                                     
				 
			 
       
                                                                         
    
                                                                 
                                                                                       
          

                                                                 
                                                                                        
          

                                                                 
                                                                                        
          

            
                                                                                          
    
                           
	 
	       
		              
		 
			                                                                                                
			                                                                                                
			                                                             
		 
	      
	                                                                                   
 
       
                                                                                                                                      
 
	                            

	                       
	                         

                    
		                    
		 
			                     
			                                                                                    
			                                                                                          
		 
		    
		 
			            
			 
				       
					                                                                                  
					     

				       
					                                                                                   
					     

				       
					                                                                                   
					     

				        
					                                                                                     
			 
		 
      
              
   
          
                                                                                      
         

          
                                                                                       
         

          
                                                                                       
         

           
                                                                                         
   
                          
	                                                                                                                                   
 

                                              
 
	                                       
 

                                                     
 
	                    
	          
	           

	                 
	 
		            
			                                                              
			                                                         
			                                                                                                          
			                                                                  
			                                                                                                        
			     
		               
			                                                              
			                                                         
			                                                                                                         
			                                                                  
			     
		            
			                                                              
			                                                         
			                                                                                                        
			                                                                                                          
			     
	 
 

                                   
 
	                                                 
	                       
	 
		                                                    
		                       	                            
	 
 

                                         
 
	                    
	                                                  
	                                      
 

                                       
 
	                                       
 

                                              
 
	                    

	                                                                                            
	                                                      
	                                                 

	                       
	                      
	           
	                                                    

	                                     
 

                                      
 
	                    
	                                    
 

             
                                                               
 
	                             

	        

	                                                                              
	                                                          

	        

	                      
		              

	                                                          
	                                                                             
 

  
                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                 
  

                                                 
 
	                              

	                                                                     
	                                                                
	                                                                                                               

	                               
	                                                                                                                

	                                                               
		        
	                    
		            

	                                                                                                                        
	                               
	                                                                          
	                                                                                                      
	       
		              
		 
			                                                                                                
			                                                                                                
			                                                             
		 
	      
	             

	                                                       

	                                                           

	                                                                                
	                                                
	                                                                           
	                   
	                                                                                  
	                                                  
	                                                               

	                                                                                                                     

	                                 
		           

	                     
		             

	                                                       
	                                          
	                     

	        

	                                   
	                               
	                                                                          

	                                                             

	                                           
	                                                   
		           

	                                                            
	                                                                                  

	                                                       

	                                             
	                                          

	                                                                                                              
	                               
	                                                                        

	                                                                         
		        

	                                                  

	                                                                        
 

                                                           
 
	                                
	                                       
	                                         

	            
		                       
		 
			                                                             
			 
				                                                       
			 
		 
	 

	             
 

                                                        
 
	                                
	                                   

	            
		                       
		 
			                                                             
			 
				                                                     
			 
		 
	 

	             
 

                                                              
 
	                                                                         
		                                                       

	                                                                       
		                                                         

	                                                                   
		                                                     

	                                                        
		            

	                                                          
		            

	                                                      
		            

	           
 

                                                         
 
	                                
	                                                     

	             
	 
		                                                                                                                              
		 
			                                                                                                  
			                                      
		 

		                                                                                                                      
		 
			                                                                                              
			                                      
		 

		                                                                                                                              
		 
			                                                                                                    
			                                      
		 

		           
	 
 

  
                                                                                                                                       
                                                                                                                                                   
                                                                                                                                               
                                                                                                                                                   
                                                                                                                                               
                                                                                                                                     
  

                                                    
 
	                              

	                                                                     
	                                                                

	                                                                                                               

	        

	                                                                        
	                               
	                                                                       

	                                                              

	                                                           
	                                                                           
	                   
	                                    
	                                                                
	                                                               

	                                                                                                                    

	                                 
		           

	                    
		            

	                                                       
	                                           
	                                          
	                     

	                                                            

	                                                                              
		        

	                     
	                                                                           
	                                                                           

	                               
	                                                                
	                                           
	                                                                            

                    
		                     
		 
			                                                          
		 
		    
		 
			                                                                   
		 
      
                                                            
                              



	                                                           
	                             

	                                                                                                                

	                                                                 
	                                                                                 
	                                                                                                      
	             

	        

	                                                                                                               

	                                                          

	                                                                                                        
	                                                                                  
	                                                                                                
	             

	                                                                         

	                                                                          
	 
		                                                                                                                                      
		                                                                             
	 

	                                                                            
		        

	                               
	                                                                           
 

                                                 
 
	                                
	                                             

	                                                                         
	                                                                 

	             
	 
		                                                          
		 
			                                                                                         
			                                      
		 

		           
	 
 

  
                                                                             
                                                                                   
                                                                                    
                                                                                  
                                                                              
                                                                       
  

                                                 
 
	                              

	                                                                     
	                                                                

	                                                                                 
	                                                                                                               
	                                                                   
	                                                                                                      
	             

	                                                                                             
	                                                                   
	                                                                                                
	             

	                                                           
	                                                        
	                                                      
	                                                    

	                                                                                  

	                                              
	                                                                                    
	                                                   

	                                                    
	                                                                   
	                                                                                                
	             

	                                                                     
		        

	                                                                                                                                               
	                               
	                                                                                      
	                                                                                                                 
	                                                                           
	                                                                                                
	             

	                                    
	        
	                     
		             
 

                                                  
                                                                                             
 
	                     
		      

	                                           
		      

	                                                          
		      

	                                                          
 

                                                                                    
 
	                                           
		      

	                          
		      

	                                                                                

	                                                
		                                                     

	                                          
		                                                   
 


  
                                                                                                                         
                                                                                                                           
                                                                                                                 
                                                                                                                         
                                                                                                                           
                                                                                                                   
  

                                                   
 
	                              

	                                                                     
	                                                                
	                                       

	                                                                                                                         
	                                                               

	                                                         

	         

	                                                            

	                               

	                                                                                                                

	                                                      
                    
		                     
		 
			                                                              
				        
		 
		    
		 
			                               
			                                     

			                                                                              

			                                              
			                                                                                            
			 
				                              
				        
			 
			                                      
		 
      
                                                                
           
                              

	                    
		            

	                                                               

	                                                        
	                                                                          

	                                       
	                                                         

	                                                                                                      
	        

	                                                                                                                      
	                                                                          
	                                                                                                       
	             

	                                                             
	                                                                            
	                                                                                                 
	             

	                                                  
	            
	                                                                             
	                                

	                                                                                               
	                                                                            
	                                                                                                 
	             

	                                                                                                                     
	                                                                            
	                                                                                                 
	             

	                                                                                    
	                                                                      

	                                                              
	                                                     

	                                                             

	                                         

	                         
	                     

	                               
	                                                                                                     
	                               
	                                                                                   
	                                                                                                 
	             

	                       
	                                                                               
	                                                                                     

	                                                                        
	                                                                                                 
	                                                                    
	                              
		                                            

	                                                                                                        
	                                                                   
	                                                                                                                        

	                                                                       

	                                                          

	                                            

	                                       
	             
	 
		        

		                                 
		                                                                                                  
		                                                            
		                             
		 
			                                                                                                        
			                                                            
			                                                                                                                        
		 
		                                     

		                                                                                                  
			        

		        

		                                                    
			     

		                                                                                 
		                                                                       
		 
			                               
			                                                                           
			                                                                                                 
			                                                                      
		 

		                                       
		                                         
		                                                            
		                                                                                         
	 

	        
 

                                                                          
 
	                                               
	                 
	                                

	                               
	                                                      

	            
		                     
		 
			                    
			 
				               
				                                                                    
			 
		 
	 

	             
	 
		             
		                    
		 
			               
			                                                                                                     
			        
			                                                                    
		 
		                               
	 
 

                                                                                      
 
	                              

	                               

	                                                                                                                                                                                                                     
	                                                                                                 
	                               
	                                                                        
	                                                                                                       
	             

	                                                                           
	 
		                              
		      
	 

	                                                                                   
	                                                                                                     
	                                                                        
	                                                                                                 
	             

	                              

	                                                            

	                                                                                           
 

                                              
 
	                               
	        
	            
	                                                           
	                                                                          
	         
	                                                           
 
 
                                                                          
 
	                                
	                               
	                              

	         

	              
	 
		                    
			            
		                                                                                                           
		                                 
		                                                                                            
		                                                                                                                                  

		                                                                                 
		                           
			        

		                             
		                    
			            

		                                                  

		                                                     
			     
	 

	                                                                  
 

                                                                          
 
	                              
	                               
	                              
	                                            

	                                           

	                                                                                                                

	            
		                                                     
		 
			                        
			 
				                                                                                   
				                                           
				                  
				                    
				                       
				                                   
				                                  
				                                
			 

			                       
			 
				                 
				                   

				                                                                                          
				 
					                                   
					                                   
					                                         
				 
				    
				 
					                                                                  
					                                                              
				 
			 
		 
	 

	                                  

	                                         

	              
	                                                 
	                                         
	                                
	                                  
	                                                               
	                                    
	                                               
	                                                      
	                                                        
	                                                           

	             
	                                                             

	                                                                             

	                                                                                                                                               
	                                  
	                          
	 
		           
		                                             
			      
	 

	                                                     
 

                                                
 
	                                                                    

	           

	                        
	 
		                                             
	 
 

                                                                 
 
	                               
	                                
	                                               
	                                                    
 


  
                                                                                                                                                              
                                                                                                                                                                        
                                                                                                                                                                          
                                                                                                                                                                              
                                                                                                                                                                
                                                                                                                                                          
  

                                                    
 
	                              

	                                                                     
	                                                                

	           

	                                                  
	                                                                  

	                                                                          

	                                                                             

	                                                                        
	                                                                                                  
	                               
	                                                                               
	                                                                                                       
	             

	                                          

	                                                                                  
	                                                                               
	        
	                                                                          
	                
	                                         
	                                        
	        
	                                      

	                                                                           
	                                                                                                     
	                                                                       
	                                                                                                 
	             

	                                                  
	                                                                       
	                                                                                                
	             

	                                                          
	                                                                

	                                                                                                                     

	                                    
	                                                                                          
	                    
	                                              

	              
	 
		                                                                                
		                           
			     
	 

	                    
		            
	                                
	                      

	                                                                                   
	                  
	                                                                  
	        
	                                                 

	                                                    
	                                                                    

	                                                                                                         
	                                                                                                     

	                                                                       
	                                                                                                
	             

	                         
	               
                    
		                      
		 
			                                            
			                                                    
				                                            
		 
		    
		 
			                                                                         
			                              
			                                                    
				                              
		 
      
                                              
                                                      
                                               
                              

	                                                                                                           
	                                   
	                                                          
	                               
	                                   
	                                                            
	                                    
	                                                          
	                      
	                                                                                    
	                                                                 

	                                                                                                                                                                                                                                                              
	                                         
	                                                               
	                                                                           

	                                                                    
	                                                                                  
	         
	                                                 

	                                                                               
	                                                                                                  
	                               
	                                                                 

	                                          
	                                                                        
	                          
	                                                    
	                                                                      
	                                                                                                                            

	                                                              

	                                     
	                                                              
		        

	                     
		             
	                                                 
	                                      
	                            

	                                                                                                                                                                                                                                              
	                              
	                                                  

	                                               
	                             

	                              
	                                                                                                     
	                               
	                                                                       
	                                                                                                
	             

	                                           
	                                      

	                                                            
	                                                                   
	                                                                    

	                                                                   

	                        
	                                                                                                     
	                               
	                                                                              
	                                                                                                
	             
 

                                                                  
 
	                     
	                                       

	           
	                                                            
	                                

                    
		                     
		 
			                                                                                                                  

			                                                          
			                                                                 
			                                                                  
		 
		    
		 
			                                                                                                       
			                                                             
			                                            
			                                            

			       
				              
				 
					                                                                              
					                                                              
				 
			      

			                                                               
			                                                                                             
			                                             

				                     
			                 
			           
			                                          
			                                
			                                                                                                                                         
			                           
			                                        
			                                  
			                    
			                                      
			                                                         
			             
			                        
				      

			                   
			               

			                 
			           

			                                                                         
			                                             
		 
      
                                                                                                                    

                                                            
                                                                   
                                                                    
                          
 

                                                     
 
	             
	             
                    
	                     
	 
		                         
		                         
	 
	    
	 
		                                                 
		                    
		                    
	 
      
                           
                           
                          

	                                                
	                                                             
	                         
	                          
	                             
	                              
	                                                    
	                                                      
	                                   
	                                                     

	                              

	                            
	                            
	                                                                                                         

	                                  

	                                                                                    
	                                    
	                                 
	                                     
	                                     

	                                                                             
	                        
	                                                                                 
	                      
	                                                                            
	                  
 

                                                                                    
 
	                      
	              
		                                          

	                                                                        

	                         
	                                               

	           
	                        
	                   
	                      
	                                                          
	              
	 
		                                                           
		                                      
		                                                
		                                 
	 

	          
 

                                               
 
	                                
	                                       

	                                                                                                                               
	                           
	                                      
	                                

	                                                
	        
	                                                
	        
	                     
		                 
	               
 
#endif

#if CLIENT
void function TrainingDeathBoxCreated( entity ent )
{
	if ( ent.GetTargetName() == DEATH_BOX_TARGETNAME_TRAINING )
	{
		entity localViewPlayer = GetLocalViewPlayer()
		if ( !IsValid( localViewPlayer ) || ent.DoesShareRealms( localViewPlayer ) )
			thread CreateDeathBoxRui( ent )
	}
}
#endif

void function Training_RespawnChamberOnUse( entity respawnChamber, entity player, int pickupFlags )
{
	#if SERVER
		                                           
			      

		                                                                         
			      
	#endif

	if ( !IsBitFlagSet( pickupFlags, USE_INPUT_LONG ) )
		return

	printt( "Training_RespawnChamberOnUse" )

	#if SERVER
		                                                                              
		 
			                                                                                                        
			                                                                    
			                               
			                                                                 
			                                                                             
		 
	#endif

	ExtendedUseSettings settings
	settings.successSound = RESPAWN_BEACON_SUCCESS_SOUND
	#if CLIENT
		settings.loopSound = RESPAWN_BEACON_LOOP_SOUND
		settings.displayRui = $"ui/health_use_progress.rpak"
		settings.displayRuiFunc = DisplayRuiForRespawnChamber
		settings.icon = $""
		settings.hint = "#HINT_RESPAWNING"
		settings.icon = RESPAWN_BEACON_ICON
	#elseif SERVER
		                                                
		                            
		                               
		                             
	#endif
	settings.duration = RESPAWN_BEACON_RESPAWN_TIME + 2.0
	settings.useInputFlag = IN_USE_LONG

	thread ExtendedUse( respawnChamber, player, settings )
}

#if CLIENT
void function DisplayRuiForRespawnChamber( entity ent, entity player, var rui, ExtendedUseSettings settings )
{
	RuiSetBool( rui, "isVisible", true )
	RuiSetImage( rui, "icon", settings.icon )
	RuiSetGameTime( rui, "startTime", Time() )
	RuiSetGameTime( rui, "endTime", Time() + settings.duration )
	RuiSetString( rui, "hintKeyboardMouse", settings.hint )
	RuiSetString( rui, "hintController", settings.hint )
}
#endif

#if SERVER
                                                                                                      
 
	                                     

	                                               
		      

	                                                               
 
#endif

  
                                                                                                                                                                      
                                                                                                                                                                              
                                                                                                                                                  
                                                                                                                                                  
                                                                                                                                                                
                                                                                                                                                      
  

#if SERVER
                                                     
 
	                              

	                                                                     
	                                                                

	                                                                                                 

	                                                                   

	                                                                                                                                                           
	                               
	                                                                        
	                                                                                                       
	             

	                                                           

	                                                                        
	                                                                                                 
	                                                                    
	                              
		                                            

	                       
	                                                                               
	                                                                                     
	                                                                                                        
	                                                                   
	                                                                                                                        

	                                                  
	                                                     
	                                                 

	                                                       

	                                     
	                                  
	 
		        

		                                 
			     

		                                                                                                 
			     
	 
	                                                     
	                                   

	                 
	                                                                        
	                                                                                                 
	             

	                                                                        

	         

	                                                                                                  

	                                                                                                                
	                                                                        
	                                                                                                 
	             

	                                                                                                                                                                                          
	                                                                               
	       
		              
		 
			                                                                                     
			                                                                                     
			                                                              
		 
	      
	                                                                                                 
	             

	        

	                              
	 
		                                                                                                 
		             

		                                                                                                 
		             

		                                                                                                     

		                                                                                                 
		             
	 
	    
	 
		                                                                                                     

		                             
		                                                                      
		                                                                                                 
		             
	 

	                
	                     
	  	                    
	  	 
	  		                                                                            
	  		                                                   
	  	 
	        

	                                    

	        

	                                           
	                                      
 

                                                                                       
 
	                                                 

	                                           
		                    
		 
			                                                                  
			                                                                  
		 
	   

	                                                                                                                                                   
	                                                                                                 
	                                                                        
	                                                                                                       
	             

	                                                                      
		      

	                                                                                       
	                                                                                                 
	                                                                    
	                                                                                                 
	             
 

                                                                
 
	                          
		      
	                                 

	                                             
	 
		                 
		      
	 

	                                               
 
#endif

  
                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                              
  

bool function Tutorial_TryAction_OpenLootBin1( entity player, InputHint inputHint )
{
	#if SERVER
		                                           
			            

		                                                        
			            

		                                      
	#endif

	return true
}


bool function Tutorial_TryAction_OpenLootBin2( entity player, InputHint inputHint )
{
	#if SERVER
		                                           
			            

		                                                        
			            

		                                      
	#endif

	return true
}


bool function Tutorial_TryAction_TakeFrag( entity player, InputHint inputHint )
{
	#if SERVER
		                                           
			            

		                                                      
			            

		                                      
	#endif

	return true
}


bool function Tutorial_TryAction_TakeThermite( entity player, InputHint inputHint )
{
	#if SERVER
		                                           
			            

		                                                          
			            

		                                      
	#endif

	return true
}


bool function Tutorial_TryAction_TakeHealth( entity player, InputHint inputHint )
{
	#if SERVER
		                                           
			            

		                                                        
			            

		                                      
	#endif

	return true
}


bool function Tutorial_TryAction_SwapGrenade( entity player, InputHint inputHint )
{
	#if SERVER
		                                           
			            

		                                                        
			            

		                                      
	#endif

	return true
}


bool function Tutorial_TryAction_ThrewGrenade( entity player, InputHint inputHint )
{
	#if SERVER
		                                           
			            

		                                                      
			            

		                                                                    

		                                                                    
			                                                                   

		                                      
	#endif

	return true
}


bool function Tutorial_TryAction_UseHealth( entity player, InputHint inputHint )
{
	#if SERVER
		                                           
			            

		                               
			            

		                                                                    

		                                                                  
			                                                                 

		                                      
	#endif

	return true
}


bool function Tutorial_TryAction_PickedUpWeapon( entity player, InputHint inputHint )
{
	#if SERVER
		                                           
			            

		                                                      
			            

		                                      
	#endif

	return true
}


bool function Tutorial_TryAction_PickedUpAmmo( entity player, InputHint inputHint )
{
	#if SERVER
		                                           
			            

		                                                                                                                 
			            

		                                      
	#endif

	return true
}


bool function Tutorial_TryAction_ShotTrainingTargets( entity player, InputHint inputHint )
{
	#if SERVER
		                                           
			            

		                                                             
			            

		                                      
	#endif

	return true
}


bool function Tutorial_TryAction_SecondWeapon( entity player, InputHint inputHint )
{
	#if SERVER
		                                           
			            

		                                                     
			            

		                                                                                                                     
		 
			                                                                                                              
			                                                                                                              
		 

		                                      
	#endif

	return true
}


bool function Tutorial_TryAction_ThirdWeapon( entity player, InputHint inputHint )
{
	if ( SURVIVAL_GetPrimaryWeapons( player ).len() < 2 )
		return false

	#if SERVER
		                                           
			            

		                                                                                                                     
			            

		                                                                                                                    
		                                                                                                                    
			            

		                                      
	#endif

	return true
}


bool function Tutorial_TryAction_PingEnemyLocation( entity player, InputHint inputHint )
{
	#if SERVER
		                                           
			            

		                                                           
			            

		                                      
	#endif

	return true
}


bool function Tutorial_TryAction_PingWeapon( entity player, InputHint inputHint )
{
	#if SERVER
		                                           
			            

		                                                      
			            

		                                      
	#endif

	return true
}


bool function Tutorial_TryAction_PingAmmo( entity player, InputHint inputHint )
{
	#if SERVER
		                                           
			            

		                                                    
			            

		                                      
	#endif

	return true
}


bool function Tutorial_TryAction_OrdnanceMenu( entity player, InputHint inputHint )
{
	#if SERVER
		                                           
			            

		                                                            
			            

		                                      
	#endif

	return true
}


bool function Tutorial_TryAction_PingMenu( entity player, InputHint inputHint )
{
	#if SERVER
		                                           
			            

		                                                        
			            

		                                      
	#endif

	return true
}


bool function Tutorial_TryAction_Pathfinder( entity player, InputHint inputHint )
{
	#if SERVER
		                                           
			            

		                                                         
			            

		                                      
	#endif

	return true
}


bool function Tutorial_TryAction_ReviveDummy( entity player, InputHint inputHint )
{
	#if SERVER
		                                           
			            

		                                                      
			            

		                                      
	#endif

	return true
}


bool function Tutorial_TryAction_HealDummy( entity player, InputHint inputHint )
{
	#if SERVER
		                                           
			            

		                                                     
			            

		                                      
	#endif

	return true
}


bool function Tutorial_TryAction_PickUpDNA( entity player, InputHint inputHint )
{
	#if SERVER
		                                           
			            

		                                                     
			            

		                                      
	#endif

	return true
}


bool function Tutorial_TryAction_UsedRespawnChamber( entity player, InputHint inputHint )
{
	#if SERVER
		                                           
			            

		                                                            
			            

		                                      
	#endif

	return true
}


bool function Tutorial_TryAction_UsedUltimate( entity player, InputHint inputHint )
{
	#if SERVER
		                                           
			            

		                                                      
			            

		                                      
	#endif

	return true
}

#if CLIENT
void function ServerCallback_MonitorCommsMenuUsage( int type )
{
	thread ServerCallback_MonitorCommsMenuUsage_thread( type )
}

void function ServerCallback_MonitorCommsMenuUsage_thread( int type )
{
	entity player = GetLocalViewPlayer()
	if ( !IsValid( player ) )
		return

	EndSignal( player, "OnDeath" )
	EndSignal( player, "OnDestroy" )

	float openMenuDuration = 0.0
	int menuStyle          = type == 0 ? eCommsMenuStyle.ORDNANCE_MENU : eCommsMenuStyle.PING_MENU

	while( IsValid( player ) )
	{
		if ( IsCommsMenuActive() && CommsMenu_GetCurrentCommsMenu() == menuStyle )
			openMenuDuration += 0.1
		else
			openMenuDuration = 0.0

		if ( openMenuDuration >= 0.4 )
		{
			Remote_ServerCallFunction( "ClientCallback_TrainingUsedCommsMenu", type )
			return
		}

		wait 0.1
	}
}

void function ServerCallback_SetCommsDialogueEnabled( int enabled )
{
	if ( enabled == 1 )
		SetCommsDialogueEnabled( true )
	else
		SetCommsDialogueEnabled( false )
}

#endif

#if SERVER
                                                                             
 
	                                           
		      

	                
	 
		                                                           
	 
	                     
	 
		                                                       
	 
 
                                                                                   
 
	                                          
	 
		                                   
	 
 
#endif

#if SERVER && DEV
                                                                                       
 
	                                               
	                                                       
	                                                                           

	                                                 
 

                                       
 
	                             
	                                  

	                                            
	 
		                                                                               
	 
	    
	 
                     
		                     
		 
			                                         
		 
		    
		 
			                                         
		 
       
                                           
                           
	 

	                                     
	                                                  
	                             
 
#endif


#if SERVER || CLIENT
bool function IsRandomizedTrainingPlaylistEnabled()
{
	return GetCurrentPlaylistVarBool( "sur_randomized_training_enabled", true )
}
#endif                    


                               
#if SERVER
                                                                    
 
	                                           
	                               
	                            
	                                                           
	                                                                                                         
	                                      
	                                                                                                                                                                                                           
	 
		                                                 
		                                                                           
	 
 
#endif
                                     